<context>
<input pattern="(привет *|здравствуй* *|здорово *|добр* (день|вечер|утро))">
    <output value="Вас приветствует бот-помощник кинотеатра Кинотеатр! Чем я могу вам помочь?"/>

    <!--купить билет-->
    <context id="buy_tickets">

    <input pattern=" * {(купить|забронировать) билет* } [на [фильм] $Text] *">
        <var name="Film" value="$Text" if="full($Text)" scope="user"/>

    <!--сразу спросить время, если есть название фильма-->
    <context id="ask_time" if="full($Text)" />

        <!--спросить название фильма   -->
         <context if="empty($Text)" modal="true">
             <output value="Пожалуйста, введите название фильма"/>
                <input pattern="$Text">
                <var name="Film" value="$Text" scope="user"/>
                    <context id="ask_time"/>
                </input>
        </context>

        <!--спросить дату и время сеанса-->
        <context id="ask_time">
            <output value="$Film - отличный выбор. А теперь, пожалуйста, выберите дату и время сеанса"/>
            <input pattern="$Date [в] $Time">
                <var name="DateFilm" value="$Date" scope="user"/>
                <var name="TimeFilm" value="$Time" scope="user"/>
                <output value="Проверяем наличие билетов на $Film $DateFilm в $TimeFilm"/>
                </input>
        </context>


        </input>
    </context>

    <!--вернуть билет-->
    <context id="return_tickets">
        <input pattern=" * {(вернуть|сдать) билет*} *"/>
        <output value="Пожалуйста, введите номер заказа"/>
    </context>

</input>
</context>