<context>
<input pattern="(привет *|здравствуй* *|здорово *|добр* (день|вечер|утро))">
    <output value="Вас приветствует бот-помощник кинотеатра Кинотеатр! Чем я могу вам помочь?"/>

    <!--купить билет-->
    <context id="buy_tickets">

    <input pattern=" * {(купить|забронировать) билет* } [на [фильм] $Text][.!]">
        <var name="Film" value="$Text" if="full($Text)" scope="user"/>

    <!--сразу спросить время, если есть название фильма-->
    <context id="ask_time" if="full($Text)" />

        <!--спросить название фильма   -->
         <context if="empty($Text)" modal="true">
             <output value="Пожалуйста, введите название фильма"/>
                <input pattern="$Text">
                <var name="Film" value="$Text" scope="user"/>
                    <context id="ask_time"/>
                </input>
        </context>

        <!--спросить дату и время сеанса-->
        <context id="ask_time">
            <output value="$Film - отличный выбор. А теперь, пожалуйста, выберите дату и время сеанса"/>
            <input pattern="$Date [в] $Time">
                <var name="DateFilm" value="$Date" scope="user"/>
                <var name="TimeFilm" value="$Time" scope="user"/>
                </input>
            <output value="Проверяем наличие билетов на $Film $DateFilm в $TimeFilm"/>
        </context>

        <context id="ask_place">
            <output value="Сбоводные места:      <br/>
                           _________экран________<br/>
                           ряд1: 1 2 3 x x 6 7 8 <br/>
                           ряд2: 1 x 3 4 5 6 7 8 <br/>
                           ряд3: 1 2 x x x 6 7 8 <br/>
                           ряд4: 1 x 3 4 5 6 x x <br/>
                           ряд5: 1 2 3 4 5 6 7 8 <br/>
                           ряд6: 1 x x x 5 6 7 8 <br/>
                           Пожалуйста, введите номера мест в формате ряд.место через запятую"/>
            <input pattern="$Text">
                <output value="Места $Text забронированы. Ваш номер заказа 12345678.
                Переход на страницу оплаты по ссылке kinoteatr.ru/payments/12345678"/>
            </input>
        </context>

        <!--<context id="next_action">-->
            <!---->
        <!--</context>-->


        </input>
    </context>

    <!--вернуть билет-->
    <context id="return_tickets">
        <input pattern=" * {(вернуть|сдать) билет*} *">
        <output value="Пожалуйста, введите номер заказа"/>
            <context>
                <input pattern="$Text">
                    <output value="Ваш номер заказа: $Text. Перейти на страницус подтверждением отмены заказа
                                    можно по ссылке kinoteatr.ru/return/$Text"/>
                </input>
            </context>
        </input>
    </context>

</input>
</context>